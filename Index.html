<div id="weather-widget" style="
  max-width: 240px;
  background: #f5f1e9; /* beige clair neutre */
  border-radius: 14px;
  padding: 20px;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  color: #4a4a4a;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  text-align: center;
">
  <h3 style="margin-bottom: 15px; font-weight: 600;">M√©t√©o locale</h3>
  <p id="city" style="font-size: 1.2em; margin: 8px 0;">Chargement...</p>
  <div id="icon" style="font-size: 48px; margin: 10px 0;"></div>
  <p id="temp" style="font-size: 2em; margin: 6px 0; font-weight: 700;"></p>
  <p id="desc" style="font-size: 1em; font-style: italic; margin: 6px 0; text-transform: capitalize;"></p>
</div>

<script>
  const apiKey = 'bee85c5f8eaca0dfbc7b4ba83c08096c'; // Remplace par ta cl√© API OpenWeatherMap

  const weatherIcons = {
    '01d': '‚òÄÔ∏è',
    '01n': 'üåô',
    '02d': 'üå§Ô∏è',
    '02n': 'üå§Ô∏è',
    '03d': '‚õÖ',
    '03n': '‚õÖ',
    '04d': '‚òÅÔ∏è',
    '04n': '‚òÅÔ∏è',
    '09d': 'üåßÔ∏è',
    '09n': 'üåßÔ∏è',
    '10d': 'üå¶Ô∏è',
    '10n': 'üå¶Ô∏è',
    '11d': '‚õàÔ∏è',
    '11n': '‚õàÔ∏è',
    '13d': '‚ùÑÔ∏è',
    '13n': '‚ùÑÔ∏è',
    '50d': 'üå´Ô∏è',
    '50n': 'üå´Ô∏è',
  };

  async function fetchWeatherByCoords(lat, lon) {
    try {
      const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&lang=fr&appid=${apiKey}`;
      const res = await fetch(url);
      if (!res.ok) throw new Error('Erreur API m√©t√©o');
      const data = await res.json();

      document.getElementById('city').innerText = data.name;
      document.getElementById('temp').innerText = `${Math.round(data.main.temp)} ¬∞C`;
      document.getElementById('desc').innerText = data.weather[0].description;
      document.getElementById('icon').innerText = weatherIcons[data.weather[0].icon] || '‚ùî';

    } catch (err) {
      document.getElementById('city').innerText = 'Erreur m√©t√©o';
      document.getElementById('temp').innerText = '--';
      document.getElementById('desc').innerText = '';
      document.getElementById('icon').innerText = '';
      console.error(err);
    }
  }

  function requestLocation() {
    if (!navigator.geolocation) {
      document.getElementById('city').innerText = 'G√©olocalisation non support√©e';
      return;
    }

    navigator.geolocation.getCurrentPosition(
      position => fetchWeatherByCoords(position.coords.latitude, position.coords.longitude),
      error => {
        document.getElementById('city').innerText = 'Position refus√©e';
        document.getElementById('temp').innerText = '--';
        document.getElementById('desc').innerText = '';
        document.getElementById('icon').innerText = '';
        console.warn(error);
      }
    );
  }

  requestLocation();
</script>
